'use strict';mix_d("CustomerReviewsMediaCards__cr-media-carousel:cr-media-carousel__3lY2d4Gd","exports tslib @c/browser-operations @c/aui-feature-detect @c/scoped-dom @c/metrics @c/navigation @c/dom @c/remote-operations @c/logger @p/A".split(" "),function(Qa,g,db,eb,fb,gb,hb,ma,na,ib,jb){function ia(a){return a&&"object"===typeof a&&"default"in a?a:{"default":a}}function Ra(a,b,c){return"https://"+oa()+"/portal/customer-reviews/media-gallery/ref="+a+"?ie=UTF8&asin="+c+"&mediaType="+b}function oa(){var a=
W["default"].getLocation&&W["default"].getLocation().hostname||location.href,b=W["default"].getLocation&&W["default"].getLocation().host||location.host;return"localhost"===a?"pre-prod.amazon.com":b}function za(a){return a?a===C.IMAGE?X.IMAGE:X.VIDEO:X.ALL}function kb(a){return Object.keys(a).map(function(b){return b+"="+a[b]}).join("&")}function lb(a,b){return g.__awaiter(this,void 0,void 0,function(){var c,d,e;return g.__generator(this,function(f){c=b.mediaType;d=b.metricsPrefix;H.logCounter(d+"IvxClicked",
1);e=Date.now();a.navigate({url:mb(b),successCallback:function(){var k=Date.now()-e;H.logCounter(d+"IvxNavigatedDuration",k);H.logCounter(d+"IvxNavigated",1);H.logNoError("loadIVXError",c)},failCallback:function(k){H.logCounter(d+"IvxNavigated",0);Sa("Failed to load SSNAP immersive modal for media: "+JSON.stringify(b)+".",k);H.logError("loadIVXError",c)}});return[2]})})}function mb(a){var b=g.__assign,c=g.__assign,d=a.hidePivot,e=a.ingressType,f=a.isSingleReview,k=a.asin,n=a.refMarker,r=a.metricsPrefix,
v=a.reviewId,p=JSON,w=p.stringify;var m=a.mediaType===C.VIDEO;m=g.__assign({imageUrl:m?a.thumbnailUrl:a.url,physicalId:a.physicalId},m&&{videoUrl:a.url});a=b.call(g,c.call(g,{hidePivot:d,ingressType:e,isSingleReview:f,productAsin:k,refMarker:n,metricsPrefix:r,reviewId:v,viewData:w.call(p,[m])},a.filter&&{filter:a.filter}),a.mediaType===C.VIDEO?{videoUrl:a.url}:{imageUrl:a.url});return"ssnap://www.amazon.com/ive?"+kb(a)}var J=ia(db),nb=ia(eb),va=ia(fb),W=ia(hb),T=ia(ma),pa=ia(na),Aa=ia(jb),C;(function(a){a.IMAGE=
"IMAGE";a.VIDEO="VIDEO"})(C||(C={}));var Ba=C,Ca,ob=function(){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(a){return[2,new Promise(function(b){P.now("mash").execute(function(c){b(c)})})]})})},Da=function(){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(a){switch(a.label){case 0:return Ca?[3,2]:[4,ob()];case 1:Ca=a.sent(),a.label=2;case 2:return[2,Ca]}})})},pb=function(){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,
function(a){switch(a.label){case 0:return[4,Da()];case 1:return[2,!!a.sent()]}})})},V;(function(a){a.MWEB="mWeb";a.MSHOP="mShop";a.DESKTOP="desktop"})(V||(V={}));var Ea=function(){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(a){switch(a.label){case 0:return[4,pb()];case 1:return[2,a.sent()]}})})},Ta=function(){return"true"===va["default"].cardRoot.getAttribute("data-mobile")||nb["default"].isSupported("mobile")},qb=function(){return g.__awaiter(void 0,void 0,
void 0,function(){var a;return g.__generator(this,function(b){switch(b.label){case 0:return(a=Ta())?[4,Ea()]:[3,2];case 1:a=!b.sent(),b.label=2;case 2:return[2,a]}})})},Ua=function(){return g.__awaiter(void 0,void 0,void 0,function(){var a;return g.__generator(this,function(b){switch(b.label){case 0:return[4,Ea()];case 1:if(!b.sent())return[3,2];a=V.MSHOP;return[3,4];case 2:return[4,qb()];case 3:a=b.sent()?V.MWEB:V.DESKTOP,b.label=4;case 4:return[2,a]}})})},H=function(){function a(){}a.setPrefix=
function(b){this.prefix=b+"."};a.logCounter=function(b,c,d){gb.count(""+this.prefix+(d?d+"."+b:b),c)};a.logError=function(b,c){this.logCounter(b,1,c)};a.logNoError=function(b,c){this.logCounter(b,0,c)};a.prefix="";return a}(),Fa;(Fa||(Fa={})).clickHandler="CRImageThumbnailOpsClickHandler";var rb=Fa,Ga;(Ga||(Ga={})).clickHandler="CRSeeMoreThumbnailOpsClickHandler";var sb=Ga,Ha;(Ha||(Ha={})).clickHandler="CRVideoThumbnailClickHandler";var tb=Ha,X;(function(a){a.IMAGE="image";a.VIDEO="video";a.ALL="all"})(X||
(X={}));var qa=function(){function a(b,c){this.popover=c;this.popoverOpenEventType="a-modal"===b?"afterShow":"afterSlide"}a.prototype.showSync=function(){var b=this;return new Promise(function(c){P.when("A").execute(function(d){var e="a:popover:"+b.popoverOpenEventType+":"+b.popover.name,f=function(){d.off(e,f);c()};d.on(e,f);b.show()})})};a.prototype.show=function(){this.popover.show()};a.prototype.hide=function(){this.popover.hide()};a.prototype.updatePosition=function(){this.popover.updatePosition()};
a.getPopoverByName=function(b){return this.popovers[b]};a.prototype.isOpen=function(){return this.popover.isActive()};a.createOrGet=function(b,c,d,e,f){var k=this;return new Promise(function(n){k.popovers[c]?n(k.popovers[c]):P.when(b).execute(function(r){va["default"].scopeElement(d);r=r.create(e,f);k.popovers[c]=new a(b,r);n(k.popovers[c])})})};a.popovers={};return a}(),ub={activate:"onclick",dataStrategy:"preload",hideHeader:!0,padding:"none"},Va={dataStrategy:"preload"},vb=function(a){function b(){return null!==
a&&a.apply(this,arguments)||this}g.__extends(b,a);b.get=function(c,d,e,f){f=f?g.__assign(g.__assign({},f),{name:c}):g.__assign(g.__assign({},ub),{name:c});return a.createOrGet.call(this,"a-secondary-view",c,d,e,f)};return b}(qa),wb=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}g.__extends(b,a);b.get=function(c,d,e,f){f=f?g.__assign(g.__assign({},f),{name:c}):g.__assign(g.__assign({},Va),{name:c});return a.createOrGet.call(this,"a-modal",c,d,e,f)};return b}(qa),xb=function(a){function b(){return null!==
a&&a.apply(this,arguments)||this}g.__extends(b,a);b.get=function(c,d,e,f){f=f?g.__assign(g.__assign({},f),{name:c}):g.__assign(g.__assign({},Va),{name:c});return a.createOrGet.call(this,"a-popover",c,d,e,f)};return b}(qa),G=function(a){a.style.display="flex"},D=function(a){a.style.display="none"},O;(function(a){a[a.LEFT=0]="LEFT";a[a.CENTER=1]="CENTER";a[a.RIGHT=2]="RIGHT";a[a.NONE=3]="NONE"})(O||(O={}));var ja;(function(a){a[a.EXPAND=0]="EXPAND";a[a.HIDE=1]="HIDE"})(ja||(ja={}));var ra;(function(a){a[a.POTRAIT=
0]="POTRAIT";a[a.LANDSCAPE=1]="LANDSCAPE"})(ra||(ra={}));var I=function(a,b){return(a=null===a||void 0===a?void 0:a.getElementsByClassName(b))?a[0]:null},wa=function(a,b){var c;return null!==(c=null===a||void 0===a?void 0:a.querySelector(b))&&void 0!==c?c:null},x=function(a,b){a&&b(a)},Wa=function(a){a=a.dataset;return{asin:a.asin,mediaType:C[a.mediatype],reviewId:a.reviewid,mediaId:a.physicalid||a.mediaid}},Xa=function(a,b){null===b||void 0===b?void 0:b.classList.remove(a)},Ya=function(a,b){null===
b||void 0===b?void 0:b.classList.add(a)},yb=function(a){var b=I(a,"_Y3Itb_desktop-skeleton-container_738lf"),c=I(a,"_Y3Itb_desktop-spinner-container_1qNHr");return{show:function(){return x(b,function(d){return G(d)})},hide:function(){return x(b,function(d){return D(d)})},setLoadingAnimation:function(d){x(c,function(e){d?b&&G(e):D(e)})}}},Ia;(function(a){a.ProfileBlock="ProfileBlock";a.ProfileBadge="ProfileBadge";a.Rating="Rating";a.RatingAlt="RatingAlt";a.ReviewText="ReviewText";a.ReviewTitle="ReviewTitle";
a.MainMedia="MainMedia";a.ImageThumbnailsBlock="ImageThumbnailsBlock";a.GalleryBlock="GalleryBlock";a.SingleReviewMediaBlock="SingleReviewMediaBlock";a.TranslateRequestBlock="TranslateRequestBlock";a.TranslationInfoBlock="TranslationInfoBlock";a.TranslationSeeOriginalBlock="TranslationSeeOriginalBlock";a.TranslateSpinner="TranslateSpinner";a.TranslateErrorDialog="TranslateErrorDialog"})(Ia||(Ia={}));var z=Ia,Ja;(function(a){a.THANKYOU_MESSAGE_TOAST_BAR_NAME="thankYouMessageToastBarName";a.ERROR_MESSAGE_TOAST_BAR_NAME=
"errorMessageToastBarName";a.LOADPOPOVER_ERROR_TOAST_BAR_NAME="loadPopoverErrorToastBarName";a.DATA_POPOVER_NAME="data-popovername";a.DATA_ASIN="data-asin";a.DATA_MEDIATYPE="data-mediatype";a.DATA_SHOW_GALLERY_IN_MODAL="data-showgalleryinmodal";a.DATA_REVIEW_ID="data-reviewid";a.DATA_MEDIA_ID="data-mediaid";a.DATA_CSA_C_TYPE="data-csa-c-type";a.DATA_CSA_SLOT_ID="data-csa-c-slot-id";a.DATA_MULTIPLE_STARS_SUFFIX="data-multiple-starts-suffix";a.DATA_ONE_STAR_SUFFIX="data-one-star-suffix";a.DATA_IMAGE_ALT_TEXT=
"data-imagealttext"})(Ja||(Ja={}));var F=Ja,Ka;(function(a){a.showMediaGalleryClickHandler="showMediaGalleryClickHandler";a.galleryItemClickHandler="galleryItemClickHandler";a.thumbnailClickHandler="thumbnailClickHandler";a.expandTextClickHandler="expandTextClickHandler";a.hideTextClickHandler="hideTextClickHandler";a.reloadMediaPopover="reloadMediaPopover";a.closeMediaPopover="closeMediaPopover";a.leftClickHandler="leftClickHandler";a.rightClickHandler="rightClickHandler";a.openReportConfirmationDialogClickHandler=
"OpenReportConfirmationDialogClickHandler";a.confirmReportAbuseClickHandler="ConfirmReportAbuseClickHandler";a.noopHandler="noopHandler";a.helpfulVoteClickHandler="HelpfulVoteClickHandler";a.translateClickHandler="translateClickHandler";a.seeOriginalClickHandler="SeeOriginalClickHandler"})(Ka||(Ka={}));var M=Ka,K;(function(a){a.UPDATE_TEXT="updateText";a.UPDATE_LANG="updateLang";a.REPLACE_CLASS="replaceClass";a.DELETE_CHILDREN="deleteChildren";a.APPEND_ELEMENT="appendElement";a.UPDATE_ELEMENT="UpdateElement"})(K||
(K={}));var Y=function(a,b,c){a=wa(a,"[data-reviewbind="+z[b]+"]");c&&a&&(a=wa(a,c));return a},Za=function(a){var b=T["default"].cardRoot.ownerDocument.createElement(a.tag);x(a.elementAttributes,function(c){Object.keys(c).forEach(function(d){return b.setAttribute(d,c[d])})});x(a.children,function(c){c.forEach(function(d){d=Za(d);b.append(d)})});x(a.observer,function(c){c.observe(b)});x(a.clickHandler,function(c){c(b)});x(a.textContent,function(c){return b.textContent=c});return b},$a=function(a,b){switch(b.type){case K.UPDATE_TEXT:x(a,
function(c){var d,e=null!==(d=b.textContent)&&void 0!==d?d:"";c.textContent=e});break;case K.UPDATE_LANG:x(a,function(c){var d,e,f=c.textContent||"",k=c.dataset.reviewlanguage||"",n=c.dataset.originalText,r=null!==(d=b.textContent)&&void 0!==d?d:"";d=null===(e=c.dataset.locale)||void 0===e?void 0:e.slice(0,2);e=new Intl.DisplayNames([d],{type:"language"});n||(c.dataset.originalText=f);if("updateLang"==r){if(k=k.slice(0,2),k=e.of(k))c.textContent=f.replace("*",k)}else n&&(c.textContent=c.dataset.originalText||
"")});break;case K.REPLACE_CLASS:x(a,function(c){x(b.classPatternToBeReplaced,function(d){var e=Array.from(c.classList).find(function(f){return f.match(d)});x(e,function(f){return c.classList.remove(f)})});x(b.newClass,function(d){return c.classList.add(d)})});break;case K.APPEND_ELEMENT:x(a,function(c){var d;null===(d=b.elements)||void 0===d?void 0:d.forEach(function(e){c.append(Za(e))})});break;case K.DELETE_CHILDREN:x(a,function(c){for(;c.lastElementChild;)c.removeChild(c.lastElementChild)});break;
case K.UPDATE_ELEMENT:x(a,function(c){x(b.elementAttributes,function(d){Object.keys(d).forEach(function(e){return c.setAttribute(e,d[e])})})})}},xa=function(a,b){a&&b.forEach(function(c){var d=Y(a,c.key,c.querySelector);$a(d,c)})},zb=function(a,b){var c=b==C.IMAGE?"cm_cr_image_carousel_popover":"cm_cr_video_carousel_popover",d=J["default"].setup(),e=function(h,l){var q,y=null!==(q=l.mediaList.findIndex(b==C.IMAGE?function(A){var E;return(null===(E=A.image)||void 0===E?void 0:E.physicalId)==h}:function(A){var E;
return(null===(E=A.video)||void 0===E?void 0:E.physicalId)==h}))&&void 0!==q?q:0;return l.mediaList[y]},f=function(h,l,q){return[{type:K.UPDATE_TEXT,key:h,textContent:l,querySelector:q}]},k=function(h,l,q,y){return[{type:K.REPLACE_CLASS,key:h,classPatternToBeReplaced:l,newClass:q,querySelector:y}]},n=function(h,l,q){return[{key:h,type:K.UPDATE_ELEMENT,elementAttributes:l,querySelector:q}]},r=["_Y3Itb_media-popover-image-view-container_vTrQA","_Y3Itb_media-popover-image-view-active_2lj7U"],v=function(h){var l=
h.mediaGroup.mediaList.map(function(q){return b==C.IMAGE?q.image:q.video}).filter(function(q){return!!q}).map(function(q,y){var A,E=g.__assign,aa=(A={class:h.mediaId==q.physicalId?r.join(" "):"_Y3Itb_media-popover-image-view-container_vTrQA"},A[F.DATA_MEDIA_ID]=q.physicalId,A);A=c+"_"+h.reviewId+"_"+h.reviewRank+"_"+q.physicalId+"_"+y;var S;y=(S={},S[F.DATA_CSA_C_TYPE]="element",S[F.DATA_CSA_SLOT_ID]=A,S);return{tag:"div",elementAttributes:E.call(g,aa,y),children:[{tag:b==C.IMAGE?"img":"video",elementAttributes:g.__assign({src:q.url,
alt:q.altText,class:"_Y3Itb_media-popover-image-view_1FAQo"},b==C.VIDEO?{controls:"true"}:{})}]}});return[{type:K.DELETE_CHILDREN,key:z.MainMedia},{type:K.APPEND_ELEMENT,elements:l,key:z.MainMedia}]},p=function(h){if(b==C.VIDEO)return[];var l=m(z.ImageThumbnailsBlock,F.DATA_IMAGE_ALT_TEXT),q=h.mediaGroup.mediaList.map(function(y){return y.image}).filter(function(y){return!!y}).map(function(y){var A;return{tag:"li",elementAttributes:{class:"_Y3Itb_media-popover-list-item-style_1njtu"},children:[{tag:"button",
elementAttributes:(A={"aria-pressed":h.mediaId===y.physicalId?"true":"false",class:h.mediaId===y.physicalId?"_Y3Itb_media-popover-thumbnail-image-view-active_2W42O _Y3Itb_media-popover-thumbnail-image-button_1vtKQ":"_Y3Itb_media-popover-thumbnail-image-button_1vtKQ"},A[F.DATA_MEDIA_ID]=y.physicalId,A[F.DATA_MEDIATYPE]=b,A),children:[{tag:"img",elementAttributes:{src:y.thumbnailUrl,alt:l,class:"_Y3Itb_media-popover-thumbnail-image-view_3-Y40"}}],clickHandler:function(E){return d.attach(M.thumbnailClickHandler,
E)}}]}});return[{type:K.DELETE_CHILDREN,key:z.ImageThumbnailsBlock},{type:K.APPEND_ELEMENT,elements:q,key:z.ImageThumbnailsBlock}]},w=function(h,l,q){return g.__spread(f(h,q),n(h,{lang:l}))},m=function(h,l,q){var y;return(h=Y(a,h,q))?null!==(y=h.getAttribute(l))&&void 0!==y?y:"":""},t=m(z.RatingAlt,F.DATA_MULTIPLE_STARS_SUFFIX),u=m(z.RatingAlt,F.DATA_ONE_STAR_SUFFIX),B=function(h,l,q){var y,A,E,aa,S,Z;switch(h){case z.ReviewText:return w(h,(null===(A=q.metadata)||void 0===A?void 0:A.sourceLanguage)||
"",null===(E=q.metadata)||void 0===E?void 0:E.text);case z.ReviewTitle:return w(h,(null===(aa=q.metadata)||void 0===aa?void 0:aa.sourceLanguage)||"",null===(S=q.metadata)||void 0===S?void 0:S.title);case z.ProfileBadge:return f(h,l.mediaGroup.contributorRelationships);case z.Rating:var ba=null===(Z=q.metadata)||void 0===Z?void 0:Z.rating;void 0===ba&&(ba=0);return g.__spread(k(z.Rating,"^a-star-.*","a-star-"+ba),f(z.Rating,ba+" "+(1<ba?t:u),"span"));case z.MainMedia:return v(l);case z.ProfileBlock:return Z=
(Z=l.mediaGroup.contributor.profile)?g.__spread(f(z.ProfileBlock,Z.profileName,".a-profile-name"),n(z.ProfileBlock,{src:Z.profileAvatarUrl},".a-profile-avatar > img"),n(z.ProfileBlock,{href:null!==(ba=Z.profileLink)&&void 0!==ba?ba:"javascript:void(0)"},"a.a-profile")):[],Z;case z.ImageThumbnailsBlock:return p(l);case z.SingleReviewMediaBlock:return n(h,(y={},y[F.DATA_CSA_SLOT_ID]=c+"_"+l.reviewId+"_"+l.reviewRank,y));default:return[]}},L=function(h){var l=n(z.TranslationInfoBlock,{"data-reviewlanguage":"*"});
l=g.__spread([l,[{type:K.UPDATE_LANG,key:z.TranslationInfoBlock,textContent:void 0,querySelector:void 0}]],[z.TranslateRequestBlock,z.TranslationInfoBlock,z.TranslationSeeOriginalBlock].flatMap(function(S){return[n(S,{"data-reviewid":h.reviewId}),n(S,{"data-mediaid":h.mediaId})]})).flat();xa(a,l);var q=g.__read([z.TranslateErrorDialog,z.TranslateSpinner,z.TranslateRequestBlock,z.TranslationInfoBlock,z.TranslationSeeOriginalBlock,z.ReviewText].map(function(S){return Y(a,S)}),6);l=q[0];var y=q[1],A=
q[2],E=q[3],aa=q[4];q=q[5];q=null===q||void 0===q?void 0:q.lang;A&&A.dataset.locale!=q?A.style.display="inline-block":A&&(A.style.display="none");l&&(l.style.display="none");y&&(y.style.display="none");E&&(E.style.display="none");aa&&(aa.style.display="none")};return{updateReview:function(h){var l=e(h.mediaId,h.mediaGroup),q=Object.keys(z).flatMap(function(y){return B(z[y],h,l)});xa(a,q);L(h)},updateMedia:function(h){h=g.__spread(n(z.ImageThumbnailsBlock,{"aria-pressed":"false"},"._Y3Itb_media-popover-thumbnail-image-view-active_2W42O"),
n(z.ImageThumbnailsBlock,{"aria-pressed":"true"},'button[data-mediaid="'+h+'"]'),k(z.ImageThumbnailsBlock,"_Y3Itb_media-popover-thumbnail-image-view-active_2W42O",void 0,"._Y3Itb_media-popover-thumbnail-image-view-active_2W42O"),k(z.ImageThumbnailsBlock,void 0,"_Y3Itb_media-popover-thumbnail-image-view-active_2W42O",'button[data-mediaid="'+h+'"]'),k(z.MainMedia,"_Y3Itb_media-popover-image-view-active_2lj7U",void 0,"._Y3Itb_media-popover-image-view-active_2lj7U"),k(z.MainMedia,void 0,"_Y3Itb_media-popover-image-view-active_2lj7U",
'div[data-mediaid="'+h+'"]'));xa(a,h)},updateReviewTitleAndBody:function(h,l,q){h=f(z.ReviewTitle,h);l=f(z.ReviewText,l);q=n(z.TranslationInfoBlock,{"data-reviewlanguage":q});q=g.__spread(h,l,q,[{type:K.UPDATE_LANG,key:z.TranslationInfoBlock,textContent:"updateLang",querySelector:void 0}]);xa(a,q)},hideTranslateSpinner:function(){var h=Y(a,z.TranslateSpinner);h&&(h.style.display="none")},showTranslateSpinner:function(){var h=Y(a,z.TranslateSpinner);h&&(h.style.display="inline-block")},showTranslationErrorDialog:function(){var h=
Y(a,z.TranslateErrorDialog);h&&(h.style.display="inline-block")}}},La=function(a,b){if(!a)return!1;b=b.some(function(c){return a.classList.contains(c)});return a.offsetHeight<a.scrollHeight&&b},Ab=function(a){var b=["_Y3Itb_cr-sidepanel-truncated-text_3nfmo","_Y3Itb_cr-sidepanel-truncated-title_2w0Qj"],c=I(a,"_Y3Itb_cr-media-popover-sidepanel-header-section_3TxI7"),d=I(c,"_Y3Itb_cr-sidepanel-text_3MYCz"),e=I(c,"_Y3Itb_cr-sidepanel-title_EX93d"),f=I(c,"_Y3Itb_cr-sidepanel-expander-see-more_1sipE"),
k=I(c,"_Y3Itb_cr-sidepanel-expander-see-less_1Hpji"),n=I(c,"_Y3Itb_cr-sidepanel-container-gradient_1zm2j"),r=function(u){La(u,b)&&(x(f,function(B){return G(B)}),x(n,function(B){return Ya("_Y3Itb_cr-sidepanel-container-gradient-truncated_3zXR9",B)}))},v=new ResizeObserver(function(u){var B;try{for(var L=g.__values(u),h=L.next();!h.done;h=L.next())r(h.value.target)}catch(q){var l={error:q}}finally{try{h&&!h.done&&(B=L.return)&&B.call(L)}finally{if(l)throw l.error;}}});x(d,function(u){v.observe(ma.unscope(u))});
x(e,function(u){v.observe(ma.unscope(u))});var p=function(){m(!0);x(f,function(u){return D(u)});x(k,function(u){return G(u)})},w=function(){m(!1);x(k,function(u){return D(u)})},m=function(u){t("_Y3Itb_cr-media-popover-sidepanel-header-section-truncated_DITiq",u,c);t("_Y3Itb_cr-sidepanel-container-gradient-truncated_3zXR9",u,n);t("_Y3Itb_cr-sidepanel-truncated-text_3nfmo",u,d);t("_Y3Itb_cr-sidepanel-truncated-title_2w0Qj",u,e)},t=function(u,B,L){B?x(L,function(h){return Xa(u,h)}):x(L,function(h){return Ya(u,
h)})};return{toggleText:function(){d&&La(d,b)||e&&La(e,b)?p():w()},hideText:w,expandText:p,initialize:function(){x(f,function(u){return D(u)});x(n,function(u){return Xa("_Y3Itb_cr-sidepanel-container-gradient-truncated_3zXR9",u)});r(d);r(e)}}},Ma=function(){function a(b){this.actionButtons=b}a.getActionButtonsContainer=function(b){var c=T["default"].cardRoot.ownerDocument.getElementsByClassName("_Y3Itb_cr-vote-report-buttons-container_1YjZZ");return Array.from(c).filter(function(d){return d.dataset.id===
b})[0]};a.prototype.likeButtonClicked=function(){var b=this.actionButtons.querySelectorAll("div[data-variant='like']")[0],c=this.actionButtons.querySelectorAll("div[data-variant='like-done']")[0];D(b);G(c)};a.prototype.resetLike=function(){var b=this.actionButtons.querySelectorAll("div[data-variant='like']")[0],c=this.actionButtons.querySelectorAll("div[data-variant='like-done']")[0];D(c);G(b)};return a}(),Bb={dataStrategy:"inline",activate:"onclick",position:"triggerVertical"},Cb=function(a){var b;
return{openTooltipPopover:function(c){return g.__awaiter(void 0,void 0,void 0,function(){var d,e,f;return g.__generator(this,function(k){switch(k.label){case 0:if(b)return[3,2];d="reportAbusePreload_"+a;e=I(c,"_Y3Itb_cr-report-abuse-preload-content_ve26F");null===e||void 0===e?void 0:e.classList.remove("aok-hidden");f=g.__assign(g.__assign({},Bb),{name:d,content:e});return e?[4,xb.get(d,e,c,f)]:[3,2];case 1:b=k.sent(),k.label=2;case 2:return b&&b.show(),[2]}})})},closeTooltipPopover:function(){return g.__awaiter(void 0,
void 0,void 0,function(){return g.__generator(this,function(c){b&&b.hide();return[2]})})},isOpen:function(){return b?b.isOpen():!1}}},Db=function(a){var b=(a=I(a,"_Y3Itb_cr-vote-report-buttons-container_1YjZZ"))?new Ma(a):void 0,c=new Set;return{initialize:function(d){c.has(d)?null===b||void 0===b?void 0:b.likeButtonClicked():null===b||void 0===b?void 0:b.resetLike()},addReviewId:function(d){null===b||void 0===b?void 0:b.likeButtonClicked();c.add(d)}}},Eb=function(a,b){var c=I(a,"_Y3Itb_left-icon-container_31i2O"),
d=I(a,"_Y3Itb_right-icon-container_3Qopb");return{initialize:function(e,f){x(c,G);x(d,G);b.isFirstMediaItem(e,f)&&x(c,D);b.isLastMediaItem(e,f)&&x(d,D)},hideButtons:function(){x(c,D);x(d,D)}}},Fb=function(a,b,c){a=I(a,"_Y3Itb_modal-content-container_XXRsT");var d=I(a,"_Y3Itb_cr-action-buttons-container_3vmwq"),e=Eb(a,b),f=Cb(c);if(!a)throw Error("modalContent element was not found");return{reportAbuse:g.__assign({},f),helpfulVote:g.__assign({},Db(a)),navigation:g.__assign({},e),toggleMediaButtonsVisibility:function(k,
n,r){if(k){if(!n||!r)throw Error("reviewId or mediaId not found: "+n+", "+r);x(d,G);e.initialize(n,r)}else f.isOpen()||(x(d,D),e.hideButtons())}}},ka=function(){function a(b,c){var d;this.toastBar=c?a.getToastBarByNameIn(b,c):a.getToastBarByName(b);this.button=null===(d=this.toastBar)||void 0===d?void 0:d.getElementsByClassName("_Y3Itb_toast-bar-button_1yIpW")[0]}a.getToastBarByName=function(b){return T["default"].cardRoot.ownerDocument.querySelector("div[data-toast-bar-name='"+b+"']")};a.getToastBarByNameIn=
function(b,c){return wa(c,"div[data-toast-bar-name='"+b+"']")};a.prototype.setClickParams=function(b){var c=this;b.forEach(function(d,e){var f;null===(f=c.button)||void 0===f?void 0:f.setAttribute(e,d)})};a.prototype.show=function(){x(this.toastBar,G)};a.prototype.hide=function(){x(this.toastBar,D)};return a}(),Gb=function(a,b,c){var d=zb(b,a),e=Ab(b),f=Fb(b,c,a),k=new ka(F.THANKYOU_MESSAGE_TOAST_BAR_NAME,b),n=new ka(F.ERROR_MESSAGE_TOAST_BAR_NAME,b),r=pa["default"].setup(["reportAbuse"]),v=pa["default"].setup(["helpful"]),
p={},w=function(h,l){x(h,function(q){p.reviewId=q});x(l,function(q){p.mediaId=q})},m=function(h,l){h=l[h];return a===C.IMAGE?h.image.physicalId:h.video.physicalId},t=function(h){return h.map(function(l){return l.type===C.IMAGE?l.image:l.video}).findIndex(function(l){return(null===l||void 0===l?void 0:l.physicalId)===p.mediaId})},u=function(){return g.__awaiter(void 0,void 0,void 0,function(){var h;return g.__generator(this,function(l){switch(l.label){case 0:if(!p.reviewId||!p.mediaId)throw Error("No reviewId present: "+
p);return[4,c.fetchNextReview(p.reviewId)];case 1:return(h=l.sent())?[4,B(m(0,h.mediaGroup.mediaList),h.mediaGroup.id)]:[3,3];case 2:l.sent(),l.label=3;case 3:return[2]}})})},B=function(h,l){return g.__awaiter(void 0,void 0,void 0,function(){var q,y;return g.__generator(this,function(A){switch(A.label){case 0:return[4,c.fetchReview(l)];case 1:q=A.sent();if(!q)throw Error("review was not fetched: "+l);y={reviewId:l,mediaId:h,reviewRank:q.reviewRank,mediaGroup:q.mediaGroup};d.updateReview(y);w(l,h);
e.hideText();e.initialize();f.helpfulVote.initialize(l);f.navigation.initialize(l,h);return[2]}})})},L=function(h){if(!p.reviewId)throw Error("no reviewId found while updating media: "+p.mediaId);d.updateMedia(h);w(p.reviewId,h);f.navigation.initialize(p.reviewId,h)};return{show:function(){return x(b,G)},hide:function(){return x(b,D)},update:function(h){var l=h.mediaId,q=h.reviewId;return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(y){switch(y.label){case 0:if(!l||
!q)throw Error("reviewId or mediaId not found: "+q+", "+l);return[4,B(l,q)];case 1:return y.sent(),[2]}})})},updateMedia:L,handleModalMediaProgressionClick:function(h){return g.__awaiter(void 0,void 0,void 0,function(){var l,q,y,A;return g.__generator(this,function(E){switch(E.label){case 0:if(!p.reviewId||!p.mediaId)throw Error("No reviewId or mediaId present: "+p);l=c.getReviewById(p.reviewId);q=t(l.mediaList);y=h;switch(y){case O.RIGHT:return[3,1];case O.LEFT:return[3,5]}return[3,10];case 1:if(!(q<
l.mediaList.length-1))return[3,2];L(m(q+1,l.mediaList));return[3,4];case 2:return[4,u()];case 3:E.sent(),E.label=4;case 4:return[3,10];case 5:if(!(0<q))return[3,6];L(m(q-1,l.mediaList));return[3,9];case 6:return[4,c.fetchPreviousReview(p.reviewId)];case 7:return(A=E.sent())?[4,B(m(A.mediaGroup.mediaList.length-1,A.mediaGroup.mediaList),A.mediaGroup.id)]:[3,9];case 8:E.sent(),E.label=9;case 9:return[3,10];case 10:return[2]}})})},handleExpanderClick:function(h){switch(h){case ja.EXPAND:e.expandText();
break;case ja.HIDE:e.hideText()}},handleReportAbuseClick:function(h){return g.__awaiter(void 0,void 0,void 0,function(){var l,q;return g.__generator(this,function(y){switch(y.label){case 0:if(!p.reviewId)throw Error("no reviewId found while reporting abuse: "+p);f.reportAbuse.closeTooltipPopover();y.label=1;case 1:return y.trys.push([1,5,,6]),[4,r.reportAbuse({reviewId:p.reviewId,asin:h,domain:oa()})];case 2:l=y.sent();if(!l.success&&l.redirectUrl)return W["default"].setLocation(l.redirectUrl),[2];
if(!l.success)return[3,4];k.show();return[4,u()];case 3:return y.sent(),[2];case 4:return l.success?[3,6]:(n.show(),[2]);case 5:throw q=y.sent(),n.show(),q;case 6:return[2]}})})},handleHelpulVoteClick:function(h){return g.__awaiter(void 0,void 0,void 0,function(){var l,q;return g.__generator(this,function(y){switch(y.label){case 0:if(!p.reviewId)throw Error("no reviewId found while handling helpfulvote call: "+p);y.label=1;case 1:return y.trys.push([1,3,,4]),[4,v.helpful({reviewId:p.reviewId,domain:oa(),
asin:h})];case 2:return l=y.sent(),!l.success&&l.redirectUrl&&W["default"].setLocation(l.redirectUrl),l.success?(f.helpfulVote.addReviewId(p.reviewId),[2]):l.success?[3,4]:(n.show(),[2]);case 3:throw q=y.sent(),n.show(),q;case 4:return[2]}})})},openReportAbuseTooltip:f.reportAbuse.openTooltipPopover,toggleMediaButtonsVisibility:function(h){f.toggleMediaButtonsVisibility(h,p.reviewId,p.mediaId)},updateReviewTranslate:function(h,l,q){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,
function(y){d.updateReviewTitleAndBody(h,l,q);return[2]})})},showTranslateSpinner:function(){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(h){d.showTranslateSpinner();return[2]})})},hideTranslateSpinner:function(){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(h){d.hideTranslateSpinner();return[2]})})},showTranslationErrorDialog:function(){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(h){d.showTranslationErrorDialog();
return[2]})})},getCurrentReviewDetails:function(){return p},updateReviewDetails:w}},Hb=J["default"].setup(),Ib=function(a){var b=0,c=function(n,r,v){var p;return p={},p[F.DATA_MEDIA_ID]=n,p[F.DATA_MEDIATYPE]=v,p[F.DATA_REVIEW_ID]=r,p[F.DATA_SHOW_GALLERY_IN_MODAL]="false",p},d=function(n){var r;return r={},r[F.DATA_CSA_C_TYPE]="element",r[F.DATA_CSA_SLOT_ID]=n,r},e=function(n){return[{tag:"img",elementAttributes:{src:n.thumbnailUrl,alt:n.altText}}]},f=function(n,r){var v={tag:"img",elementAttributes:{src:n.thumbnailUrl,
alt:n.altText}};return r?[v,{tag:"div",elementAttributes:{class:"_Y3Itb_media-gallery-item-video-overlay-container_RHWdX"},children:[{tag:"div",elementAttributes:{class:"_Y3Itb_media-gallery-item-video-overlay_cGzRu"},children:[{tag:"i",elementAttributes:{"class":"a-icon a-icon-star-mini a-star-mini-"+r.rating}},{tag:"span",textContent:"\u25b7 "+n.videoDuration}]}]}]:[v]},k=function(n,r,v,p,w){return n.map(function(m,t){var u,B=m.type==Ba.IMAGE?m.image:m.video;if(B){var L=m.type==Ba.IMAGE?e(m.image):
f(m.video,m.metadata),h=null===(u=m.metadata)||void 0===u?void 0:u.contributionId;if(h)return{tag:"button",elementAttributes:g.__assign(g.__assign({class:m.type==Ba.IMAGE?"_Y3Itb_media-gallery-item_3LROo":"_Y3Itb_media-gallery-item-video_1k9yY"},c(B.physicalId,h,m.type)),d(w+"_"+h+"_"+B.physicalId+"_"+p)),observer:t==r?v:void 0,children:g.__spread(L),clickHandler:function(l){return Hb.attach(M.galleryItemClickHandler,l)}}}}).filter(function(m){return void 0!==m})};return{updateGallery:function(n,
r,v,p){n=k(n,r,v,b,p);b++;0<n.length&&$a(a,{type:K.APPEND_ELEMENT,key:z.GalleryBlock,elements:n})}}},Jb=function(a,b,c){var d=I(b,"_Y3Itb_media-popover-gallery-container-grid_mLjpJ"),e=I(b,"_Y3Itb_gallery-spinner_34BcK"),f=a===C.IMAGE?"cm_cr_image_gallery_popover":"cm_cr_video_gallery_popover",k=new IntersectionObserver(function(p,w){p.forEach(function(m){return g.__awaiter(void 0,void 0,void 0,function(){var t;return g.__generator(this,function(u){switch(u.label){case 0:if(!m.isIntersecting)return[3,
4];u.label=1;case 1:return u.trys.push([1,3,,4]),x(e,G),[4,c.fetchReviewsNextPage()];case 2:return u.sent(),v(),x(e,D),w.unobserve(m.target),[3,4];case 3:throw t=u.sent(),t;case 4:return[2]}})})})},{root:ma.unscope(d),rootMargin:"0px",threshold:.25}),n=Ib(d),r=0,v=function(){for(var p=c.getAllReviews(),w=c.getAllReviewIds(),m=[],t=r;t<w.length;t++)m.push.apply(m,g.__spread(p[w[t]].mediaList)),r++;n.updateGallery(m,5<=m.length?m.length-5:-1,k,f)};return{hide:function(){return x(b,D)},show:function(){return x(b,
G)},update:function(){return g.__awaiter(void 0,void 0,void 0,function(){var p;return g.__generator(this,function(w){switch(w.label){case 0:return p=c.getAllReviewIds(),0!=p.length?[3,2]:[4,c.fetchReviewsNextPage()];case 1:w.sent(),w.label=2;case 2:return v(),[2]}})})},scrollToMediaId:function(p){p&&(p=wa(b,'div[data-mediaid="'+p+'"]'),x(p,function(w){return w.scrollIntoView()}))}}},Kb=function(a){var b=I(a,"_Y3Itb_media-popover-see-all-container_1Lmmi");return{show:function(){return x(b,function(c){return G(c)})},
hide:function(){return x(b,function(c){return D(c)})}}},Lb=function(a,b){var c=[],d={},e,f,k=function(){return g.__awaiter(void 0,void 0,void 0,function(){var m,t;return g.__generator(this,function(u){switch(u.label){case 0:return m=na.setup(["getGroupedMediaReviews"]),[4,m.getGroupedMediaReviews({asin:a,nextToken:e,mediaType:b,limit:50})];case 1:return t=u.sent(),n(t.mediaGroupList),e=t.nextToken,[2]}})})},n=function(m){m.forEach(function(t){d[t.id]=t;0>c.indexOf(t.id)&&c.push(t.id)})},r=function(m){return!!d[m]},
v=function(m){return c.indexOf(m)},p=function(){return g.__awaiter(void 0,void 0,void 0,function(){var m;return g.__generator(this,function(t){switch(t.label){case 0:m=0===Object.keys(d).length;if(!m&&(m||f||!e))return[3,5];t.label=1;case 1:return t.trys.push([1,,3,4]),[4,k()];case 2:return t.sent(),[3,4];case 3:return f=!1,[7];case 4:return[2,!0];case 5:return[2,!1]}})})},w=function(m,t){return d[m].mediaList.map(function(u){return u.type===C.IMAGE?u.image:u.video}).findIndex(function(u){return(null===
u||void 0===u?void 0:u.physicalId)===t})};return{fetchReview:function(m){return g.__awaiter(void 0,void 0,void 0,function(){var t,u,B,L;return g.__generator(this,function(h){switch(h.label){case 0:if(!m)throw Error("fetchReview was called without a reviewId");t=r(m);h.label=1;case 1:return t?[3,3]:[4,p()];case 2:return u=h.sent(),t=r(m),u?[3,1]:[3,3];case 3:if(r(m))return[3,5];B=na.setup(["getMediaGroup"]);return[4,B.getMediaGroup({reviewId:m})];case 4:L=h.sent(),n(L),e="",H.logCounter("desktop.missingReviewId",
1),h.label=5;case 5:return r(m)?[2,{mediaGroup:d[m],reviewRank:v(m)}]:[2]}})})},isReviewFetched:r,fetchReviewsNextPage:p,fetchNextReview:function(m){return g.__awaiter(void 0,void 0,void 0,function(){var t,u;return g.__generator(this,function(B){switch(B.label){case 0:return t=v(m)+1,t>=c.length?[4,p()]:[3,2];case 1:B.sent(),B.label=2;case 2:return u=c[t],r(u)?[2,{mediaGroup:d[u],reviewRank:t}]:[2]}})})},fetchPreviousReview:function(m){return g.__awaiter(void 0,void 0,void 0,function(){var t,u;return g.__generator(this,
function(B){t=v(m)-1;if(0>t)return[2];u=c[t];return r(u)?[2,{mediaGroup:d[u],reviewRank:t}]:[2]})})},getReviewById:function(m){return d[m]},getReviewIndexById:v,getAllReviews:function(){return d},getAllReviewIds:function(){return c},isFirstMediaItem:function(m,t){var u=v(m);m=w(m,t);return 0===u&&0===m},isLastMediaItem:function(m,t){var u=v(m);t=w(m,t);return!e&&u===c.length-1&&t===d[m].mediaList.length-1}}},sa=function(){var a={};return{setData:function(b,c){a[b]=c},getData:function(b){return a[b]},
hasData:function(b){return b in a},removeData:function(b){delete a[b]},clearData:function(){for(var b in a)a.hasOwnProperty(b)&&delete a[b]}}}(),Mb=function(a,b,c,d){var e=Lb(b,c),f=yb(d),k=Kb(d),n=new ka(F.LOADPOPOVER_ERROR_TOAST_BAR_NAME,d),r=I(d,"_Y3Itb_single-review-media-popover-container_1h9X2");if(!r)throw Error("Unable to find singleReviewMediaPopoverContainer");var v=Gb(c,r,e);d=I(d,"_Y3Itb_gallery-container_2pBFm");if(!d)throw Error("Unable to find mediaGalleryContainer");var p=Jb(c,d,e);
return{loadModal:function(w){return g.__awaiter(void 0,void 0,void 0,function(){var m;return g.__generator(this,function(t){switch(t.label){case 0:return n.hide(),v.hide(),p.hide(),f.show(),f.setLoadingAnimation(!0),w.popoverDetails.popover?[4,w.popoverDetails.popover.showSync()]:[3,2];case 1:t.sent(),t.label=2;case 2:return t.trys.push([2,4,,5]),m=w.showGalleryInModal?p:v,[4,m.update(w)];case 3:return t.sent(),m.show(),w.showGalleryInModal?k.hide():k.show(),f.hide(),[3,5];case 4:t.sent();H.logCounter("desktop.popoverLoading.Error",
1);f.setLoadingAnimation(!1);if(!w.mediaType||!w.asin)throw Error("mediaType or asin was not found while setting parameters for toastbar: "+w.mediaType+", "+w.asin);t=new Map([[F.DATA_POPOVER_NAME,w.popoverDetails.popoverName],[F.DATA_ASIN,w.asin],[F.DATA_MEDIATYPE,w.mediaType.toString()]]);if(w.showGalleryInModal)t.set(F.DATA_SHOW_GALLERY_IN_MODAL,"true");else{if(!w.reviewId||!w.mediaId)throw Error("mediaId or reviewId was not found while setting parameters for toastbar: "+w.reviewId+", "+w.mediaId);
t.set(F.DATA_REVIEW_ID,w.reviewId);t.set(F.DATA_MEDIA_ID,w.mediaId)}n.setClickParams(t);n.show();return[3,5];case 5:return[2]}})})},updateModalWithReview:function(w,m){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(t){switch(t.label){case 0:return p.hide(),k.show(),[4,v.update({reviewId:w,mediaId:m,asin:b,mediaType:c})];case 1:return t.sent(),v.show(),[2]}})})},showMediaGallery:function(){return g.__awaiter(void 0,void 0,void 0,function(){var w;return g.__generator(this,
function(m){switch(m.label){case 0:return w=v.getCurrentReviewDetails().mediaId,v.hide(),k.hide(),f.show(),f.setLoadingAnimation(!0),[4,p.update()];case 1:return m.sent(),f.hide(),p.show(),p.scrollToMediaId(w),[2]}})})},updateMediaInModal:v.updateMedia,handleModalMediaProgressionClick:v.handleModalMediaProgressionClick,handleExpanderClick:v.handleExpanderClick,openReportAbuseDialog:v.openReportAbuseTooltip,handleReportAbuseClick:function(){return v.handleReportAbuseClick(b)},handleHelpulVoteClick:function(){return v.handleHelpulVoteClick(b)},
updateReviewTranslate:v.updateReviewTranslate,closeModal:function(){return qa.getPopoverByName(a).hide()},showTranslateSpinner:v.showTranslateSpinner,hideTranslateSpinner:v.hideTranslateSpinner,showTranslationErrorDialog:v.showTranslationErrorDialog}},Nb=function(){function a(){this.desktopPopoverModalOptions={dataStrategy:"preload",hideHeader:!0,closeButton:!0,padding:"none",name:"cr-media-popover"}}a.prototype.onVideoClickHandler=function(b){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,
function(c){throw Error("Video click handler on Desktop is not yet implemented.");})})};a.prototype.onImageClickHandler=function(b){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(c){switch(c.label){case 0:return[4,this.showImagePopover(b,!1)];case 1:return c.sent(),[2]}})})};a.prototype.onSeeMoreClickHandler=function(b){var c;return g.__awaiter(this,void 0,void 0,function(){var d,e,f;return g.__generator(this,function(k){switch(k.label){case 0:return d=null===
(c=b.currentTarget)||void 0===c?void 0:c.dataset,e=C[d.mediatype],f=za(e),f!==X.IMAGE?[3,2]:[4,this.showImagePopover(b,!0)];case 1:return k.sent(),[3,3];case 2:throw H.logError("loadDesktopVideoGalleryError",f),Error("Video gallery is not available on desktop.");case 3:return[2]}})})};a.prototype.showImagePopover=function(b,c){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(d){switch(d.label){case 0:return[4,this.openModal(b,c)];case 1:return d.sent(),[2]}})})};
a.prototype.openModal=function(b,c){return g.__awaiter(this,void 0,void 0,function(){var d,e,f,k,n,r,v,p,w,m,t,u;return g.__generator(this,function(B){switch(B.label){case 0:d=b.currentTarget;e=Wa(d);if(c&&(!e.mediaType||!e.asin))throw Error("media props are missing while trying to load the modal: "+JSON.stringify(e));if(!(c||e.mediaType&&e.asin&&e.reviewId&&e.mediaId))throw Error("media props are missing while trying to load the modal: "+JSON.stringify(e));f=e.mediaType===C.IMAGE?"_Y3Itb_cm_cr_image_popoversection_3iYPp":
"_Y3Itb_cm_cr_video_popoversection_2v7yY";k=va["default"].cardRoot.getElementsByClassName(f)[0];n=k.getElementsByClassName("_Y3Itb_media-popover-container_2BBbs")[0];r=this.desktopPopoverModalOptions.name+"_"+e.mediaType;v=k.querySelector("div[data-reviewbind=SingleReviewMediaBlock]");p=(null===v||void 0===v?void 0:v.getAttribute("data-closebuttonaria"))||"";w=(null===v||void 0===v?void 0:v.getAttribute("data-modaltitlearia"))||"";m=g.__assign(g.__assign({},this.desktopPopoverModalOptions),{name:r,
closeButtonLabel:p,popoverLabel:w});return[4,wb.get(r,n,d,m)];case 1:t=B.sent();u=sa.hasData(e.mediaType)?sa.getData(e.mediaType):Mb(r,e.asin,e.mediaType,n);if(!u)throw Error("Could not load ModalManager for opening modal: "+e);return[4,u.loadModal({asin:e.asin,mediaId:e.mediaId,reviewId:e.reviewId,mediaType:e.mediaType,showGalleryInModal:c,popoverDetails:{popoverName:this.desktopPopoverModalOptions.name+"_"+e.mediaType,popover:t}})];case 2:return B.sent(),sa.hasData(e.mediaType)||sa.setData(e.mediaType,
u),t.updatePosition(),d.classList.remove("a-declarative"),[2]}})})};return a}(),Sa=function(a,b){a=b?a+". Error object: "+JSON.stringify({message:b.message,name:b.name,stack:b.stack}):a;ib.log(a,"FATAL")},ca;(function(a){a.CAROUSEL="crsl";a.IMAGES_CAROUSEL="crsl_img";a.VIDEOS_CAROUSEL="crsl_vid"})(ca||(ca={}));var da;(function(a){a.DETAIL_PAGE_WIDGET="dp";a.IMAGE_GALLERY="img";a.MEDIA_GALLERY="mg";a.OTHER="othr"})(da||(da={}));var ea;(function(a){a.SEE_MORE="sm";a.POPOVER="pop";a.IMAGE="img";a.VIDEO=
"vid"})(ea||(ea={}));var fa;(function(a){a.DESKTOP="d";a.MOBILE_APP="ma";a.MOBILE_BROWSER="mb";a.TABLET_APP="ta";a.TABLET_BROWSER="tb";a.UNKNOWN="unkn"})(fa||(fa={}));var la=function(){function a(b,c,d,e){this.page=b;this.device=c;this.widget=d;this.location=e}a.prototype.toString=function(){return a.PREFIX+a.DELIMITER+this.page+a.DELIMITER+this.device+a.DELIMITER+this.widget+a.DELIMITER+this.location};a.prototype.appendToString=function(b){return b?this.toString()+a.DELIMITER+b:this.toString()};
a.MAX_LENGTH=32;a.PREFIX="cm_cr";a.DELIMITER="_";return a}(),Ob=new la(da.DETAIL_PAGE_WIDGET,fa.MOBILE_APP,ca.CAROUSEL,ea.IMAGE),Pb=new la(da.DETAIL_PAGE_WIDGET,fa.MOBILE_APP,ca.CAROUSEL,ea.VIDEO),Qb=new la(da.DETAIL_PAGE_WIDGET,fa.MOBILE_APP,ca.IMAGES_CAROUSEL,ea.SEE_MORE),Rb=new la(da.DETAIL_PAGE_WIDGET,fa.MOBILE_APP,ca.VIDEOS_CAROUSEL,ea.SEE_MORE),Sb=new la(da.DETAIL_PAGE_WIDGET,fa.MOBILE_BROWSER,ca.IMAGES_CAROUSEL,ea.SEE_MORE),Tb=new la(da.DETAIL_PAGE_WIDGET,fa.MOBILE_BROWSER,ca.CAROUSEL,ea.VIDEO),
Ub=function(){function a(){}a.prototype.onVideoClickHandler=function(b){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(c){switch(c.label){case 0:return[4,this.onMediaClickHandler(b)];case 1:return c.sent(),[2]}})})};a.prototype.onImageClickHandler=function(b){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(c){switch(c.label){case 0:return[4,this.onMediaClickHandler(b)];case 1:return c.sent(),[2]}})})};a.prototype.onSeeMoreClickHandler=
function(b){var c;return g.__awaiter(this,void 0,void 0,function(){var d,e,f;return g.__generator(this,function(k){switch(k.label){case 0:return d=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset,e=C[d.mediatype],f=za(e),[4,this.goToGallery(b,f)];case 1:return k.sent(),[2]}})})};a.prototype.onMediaClickHandler=function(b){var c;return g.__awaiter(this,void 0,void 0,function(){var d,e,f,k,n;return g.__generator(this,function(r){switch(r.label){case 0:return d=null===(c=b.currentTarget)||void 0===
c?void 0:c.dataset,e=C[d.mediatype],f=d.rank,k={reviewId:d.reviewid,mediaType:e,url:d.url,thumbnailUrl:d.thumbnailurl,physicalId:d.physicalid,asin:d.asin,isSingleReview:!1,hidePivot:!1,refMarker:a.getIVXRefMarker(e,f),ingressType:"dpreviews",filter:e===C.IMAGE?"image":"video",metricsPrefix:e===C.IMAGE?"CarouselImageToAppX":"CarouselVideoToAppX"},[4,Da()];case 1:return n=r.sent(),n.addEventListener("com.amazon.mshop.ivx1.closed.progressPositionAndMediaIdSend",function(){this.refocusToMedia(d.physicalId);
n.removeEventListener("com.amazon.mshop.ivx1.closed.progressPositionAndMediaIdSend")}),[4,lb(n,k)];case 2:return r.sent(),[2]}})})};a.prototype.refocusToMedia=function(b){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(c){return[2,new Promise(function(d,e){var f=T["default"].cardRoot.ownerDocument.querySelector('button[data-physicalid="'+b+'"]');setTimeout(function(){null===f||void 0===f?void 0:f.focus();d()},0)})]})})};a.prototype.goToGallery=function(b,c){var d;
return g.__awaiter(this,void 0,void 0,function(){var e,f,k,n;return g.__generator(this,function(r){switch(r.label){case 0:return e=null===(d=b.currentTarget)||void 0===d?void 0:d.dataset,f=e.asin,k=c===X.IMAGE?Qb:Rb,[4,Da()];case 1:return n=r.sent(),n.navigate({url:Ra(k.toString(),c,f),successCallback:function(){H.logNoError("loadMediaGalleryError",c)},failCallback:function(v){Sa("Failed to load gallery for asin: "+f+".",v);H.logError("loadMediaGalleryError",c)}}),[2]}})})};a.getIVXRefMarker=function(b,
c){return(b===C.IMAGE?Ob:Pb).appendToString(c)};return a}(),N=function(){function a(b){var c=this;this.popover=b;this.loadMediaResources=function(){for(var d=c.popover.querySelectorAll("[data-lazyimagesource]"),e=0;e<d.length;e++){var f=d[e],k=f.getAttribute("data-lazyimagesource");f="img"===f.tagName.toLowerCase()?f:f.getElementsByTagName("img")[0];f.getAttribute("src")!=k&&f.setAttribute("src",k)}};this.getCurrentMediaIndex=function(){for(var d=c.popover.querySelectorAll("[data-mediaid]"),e=0;e<
d.length;e++)if("none"!==d[e].style.display)return e;return 0};this.getPreviousPopoverWidget=function(){return c.popover.previousElementSibling?new a(c.popover.previousElementSibling):null};this.getNextPopoverWidget=function(){return c.popover.nextElementSibling?new a(c.popover.nextElementSibling):null};this.getNumbersOfMedia=function(){return c.popover.querySelectorAll("[data-mediaid]").length};this.toggleOverlay=function(){var d=c.popover.getElementsByClassName("_Y3Itb_overlay-content-container_1ubFP")[0];
d.classList.contains("_Y3Itb_media-popover-overlay-fade-out_1eneO")?(d.classList.remove("_Y3Itb_media-popover-overlay-fade-out_1eneO"),d.classList.add("_Y3Itb_media-popover-overlay-fade-in_bZzwP")):(d.classList.add("_Y3Itb_media-popover-overlay-fade-out_1eneO"),d.classList.remove("_Y3Itb_media-popover-overlay-fade-in_bZzwP"))};this.scrollIntoSelf=function(){c.popover.scrollIntoView()};this.scrollIntoMediaByIndex=function(d){c.scrollIntoSelf();var e=!1;c.popover.querySelectorAll("[data-mediaid]").forEach(function(f,
k){e?c.removeHighlightPageIndicator(k):c.addHighlightPageIndicator(k);k==d?(G(f),e=!0):D(f)})};this.scrollIntoMediaId=function(d){c.scrollIntoSelf();c.popover.querySelectorAll("[data-mediaid]").forEach(function(e,f){e.getAttribute("data-mediaid")===d&&c.scrollIntoMediaByIndex(f)})};this.getReviewId=function(){return c.popover.getAttribute("data-reviewid")};this.getPageIndicator=function(d){var e=c.popover.getElementsByClassName("_Y3Itb_media-popover-page-indicator_36NFP")[0];if(e)return e.childNodes[d]};
this.addHighlightPageIndicator=function(d){d=c.getPageIndicator(d);null===d||void 0===d?void 0:d.classList.add("_Y3Itb_highlighted_1QxVg")};this.removeHighlightPageIndicator=function(d){d=c.getPageIndicator(d);null===d||void 0===d?void 0:d.classList.remove("_Y3Itb_highlighted_1QxVg")}}a.getPopoverWidgetById=function(b){return b?T["default"].cardRoot.ownerDocument.getElementsByClassName("_Y3Itb_media-popover-list-container_3mcnh")[0].querySelector("div[data-reviewid='"+b+"']"):null};a.prototype.handlePopoverClick=
function(b){switch(b){case O.LEFT:if(0<this.getCurrentMediaIndex())this.scrollIntoMediaByIndex(this.getCurrentMediaIndex()-1);else if(b=this.getPreviousPopoverWidget())b.scrollIntoSelf(),b.scrollIntoMediaByIndex(b.getNumbersOfMedia()-1);break;case O.CENTER:this.toggleOverlay();break;case O.RIGHT:if(this.getCurrentMediaIndex()<this.getNumbersOfMedia()-1)this.scrollIntoMediaByIndex(this.getCurrentMediaIndex()+1);else if(b=this.getNextPopoverWidget())b.scrollIntoSelf(),b.scrollIntoMediaByIndex(0)}};
a.prototype.scrollIntoNextPopover=function(){var b=this.getNextPopoverWidget()||this.getPreviousPopoverWidget();b&&b.scrollIntoSelf()};return a}(),U;(function(a){a.closePopoverClickHandler="ClosePopoverClickHandler";a.popoverClickHandler="PopoverClickHandler";a.desktopLeftClickHandler="DesktopLeftClickHandler";a.desktopRightClickHandler="DesktopRightClickHandler";a.openReportConfirmationDialogClickHandler="OpenReportConfirmationDialogClickHandler";a.helpfulVoteClickHandler="HelpfulVoteClickHandler";
a.confirmReportAbuseClickHandler="ConfirmReportAbuseClickHandler";a.noopHandler="noopHandler";a.loadMediaPopover="loadMediaPopover";a.closePopoverErrorDialogClickHandler="ClosePopoverErrorDialogClickHandler"})(U||(U={}));var Vb=function(){function a(b){this.popover=b;b=b.getElementsByClassName("_Y3Itb_cr-popover-overlay-text-container_NfghQ")[0];this.text=b.querySelector("._Y3Itb_cr-text_28H9k");this.title=b.querySelector("._Y3Itb_cr-title_3bWqW");this.expandButton=b.querySelector("._Y3Itb_cr-text-expand-button_2BWKW");
this.hideButton=b.querySelector("._Y3Itb_cr-text-hide-button_2qNi2")}a.prototype.toggleElementExpansion=function(b,c){c?(b.classList.remove("_Y3Itb_truncated_j_-Jw"),b.classList.add("_Y3Itb_expanded_2wQ4c")):(b.classList.remove("_Y3Itb_expanded_2wQ4c"),b.classList.add("_Y3Itb_truncated_j_-Jw"))};a.prototype.initResizeObserver=function(){var b=this;if(this.title||this.text)this.observer=new ResizeObserver(function(c){var d;try{for(var e=g.__values(c),f=e.next();!f.done;f=e.next())a.isTruncated(f.value.target,
"_Y3Itb_truncated_j_-Jw")&&G(b.expandButton)}catch(n){var k={error:n}}finally{try{f&&!f.done&&(d=e.return)&&d.call(e)}finally{if(k)throw k.error;}}}),this.title&&this.observer.observe(this.title),this.text&&this.observer.observe(this.text)};a.prototype.expandText=function(){this.text&&a.isTruncated(this.text,"_Y3Itb_truncated_j_-Jw")&&this.toggleElementExpansion(this.text,!0);this.title&&a.isTruncated(this.title,"_Y3Itb_truncated_j_-Jw")&&this.title.classList.remove("_Y3Itb_truncated_j_-Jw");D(this.expandButton);
G(this.hideButton);this.setPopoverOverlayGradient(!0);this.showActionButtons(!1)};a.prototype.toggleText=function(){this.text&&a.isTruncated(this.text,"_Y3Itb_truncated_j_-Jw")||this.title&&a.isTruncated(this.title,"_Y3Itb_truncated_j_-Jw")?this.expandText():this.hideText()};a.prototype.hideText=function(){this.text&&(this.text.offsetHeight<this.text.scrollHeight&&(this.text.scrollTop=0),this.toggleElementExpansion(this.text,!1));this.title&&this.title.classList.add("_Y3Itb_truncated_j_-Jw");D(this.hideButton);
this.setPopoverOverlayGradient(!1);this.showActionButtons(!0)};a.prototype.setPopoverOverlayGradient=function(b){var c=this.popover.getElementsByClassName("_Y3Itb_cr-media-popover-overlay-container_32qUq")[0];c&&(b?(c.classList.add("_Y3Itb_popover-overlay-gradient_114MI"),c.dataset.mixOperations=U.noopHandler):c.classList.contains("_Y3Itb_popover-overlay-gradient_114MI")&&(c.classList.remove("_Y3Itb_popover-overlay-gradient_114MI"),c.dataset.mixOperations&&delete c.dataset.mixOperations))};a.prototype.showActionButtons=
function(b){var c=this.popover.getElementsByClassName("_Y3Itb_cr-action-buttons-container_28a_m")[0];c&&(b?G(c):D(c))};a.isTruncated=function(b,c){return b&&b.offsetHeight<b.scrollHeight&&b.classList.contains(c)};return a}(),Na=function(a){if(a)return(null===a||void 0===a?0:a.getElementsByClassName("_Y3Itb_cr-popover-overlay-text-container_NfghQ")[0])?new Vb(a):void 0},Wb=function(){return function(){var a=this;this.show=function(){G(a.popoverList)};this.hide=function(){D(a.popoverList)};this.getNumberOfPopoversLoaded=
function(){return a.popoverList.childNodes.length};this.getNumberOfPopoversLeft=function(){if(a.currentReviewId){var b=0;a.popoverList.childNodes.forEach(function(c,d){c.getAttribute("data-reviewid")==a.currentReviewId&&(b=a.getNumberOfPopoversLoaded()-d)});return b}return a.popoverList.childNodes.length};this.addPopovers=function(b){b.querySelectorAll("._Y3Itb_media-popover-container_15D5F").forEach(function(c){c=ma.unscope(c);var d=c.getAttribute("data-reviewid");N.getPopoverWidgetById(d)||(a.popoverList.appendChild(c),
a.observer.observe(c),c=Na(N.getPopoverWidgetById(d)),null===c||void 0===c?void 0:c.initResizeObserver())})};this.scrollTo=function(b,c){a.setCurrentReviewId(b);b=N.getPopoverWidgetById(b);(new N(b)).scrollIntoMediaId(c)};this.setCurrentReviewId=function(b){a.currentReviewId=b};this.doesPopoverExists=function(b){return null!=N.getPopoverWidgetById(b)};this.getNextToken=function(){return a.popoverList.getAttribute("data-next-token")};this.setNextToken=function(b){return a.popoverList.setAttribute("data-next-token",
b)};this.setOnScrollCallback=function(b){a.onScrollCallback=b};this.popoverList=T["default"].cardRoot.ownerDocument.getElementsByClassName("_Y3Itb_media-popover-list-container_3mcnh")[0];this.observer=new IntersectionObserver(function(b){b.forEach(function(c){if(c.isIntersecting){c=new N(c.target);var d=c.getReviewId(),e=a.currentReviewId;a.setCurrentReviewId(d);if(a.onScrollCallback)a.onScrollCallback(d);c.loadMediaResources();c=Na(N.getPopoverWidgetById(e));null===c||void 0===c?void 0:c.hideText()}})},
{threshold:.5})}}(),ya=function(){function a(){this.confirmationDialog=T["default"].cardRoot.ownerDocument.querySelector("._Y3Itb_media-popover-report-abuse-confirmation-dialog_7HNIt");this.confirmButton=T["default"].cardRoot.ownerDocument.querySelector("._Y3Itb_media-popover-report-abuse-confirmation-dialog-button_35f75")}a.prototype.setReviewId=function(b){this.confirmButton.dataset.id=b};a.prototype.setAsin=function(b){this.confirmButton.dataset.asin=b};a.prototype.show=function(){G(this.confirmationDialog)};
a.prototype.hide=function(){D(this.confirmationDialog)};return a}(),ab=function(){function a(){this.popoverSkeleton=T["default"].cardRoot.ownerDocument.getElementsByClassName("_Y3Itb_media-popover-skeleton-container_3DI7n")[0];this.profileSkeleton=this.popoverSkeleton.getElementsByClassName("_Y3Itb_profile-skeleton_1JfdD")[0]}a.prototype.show=function(){G(this.popoverSkeleton)};a.prototype.hide=function(){D(this.popoverSkeleton)};a.prototype.setLoadingAnimation=function(b){b?this.profileSkeleton.classList.add("_Y3Itb_loading_3908t"):
this.profileSkeleton.classList.contains("_Y3Itb_loading_3908t")&&this.profileSkeleton.classList.remove("_Y3Itb_loading_3908t")};return a}(),ha;(function(a){a[a.Popover=0]="Popover";a[a.Gallery=1]="Gallery";a[a.ReportAbuseConfirmationDialog=2]="ReportAbuseConfirmationDialog"})(ha||(ha={}));var ta=function(){function a(){}a.getInstance=function(){a.instance||(a.instance=new a);return a.instance};a.prototype.initPopoverWidgetList=function(){null==this.popoverWidgetList&&(this.popoverWidgetList=new Wb);
return this.popoverWidgetList};a.prototype.initPopoverSkeletonClient=function(){this.popoverSkeleton=new ab};a.prototype.initPopover=function(b){a.currentScreen=ha.Popover;a.popoverName=b;this.resetOverlayComponents();this.initPopoverWidgetList();this.initPopoverSkeletonClient()};a.prototype.loadMediaPopover=function(b){return g.__awaiter(this,void 0,void 0,function(){var c,d,e,f,k,n,r,v=this;return g.__generator(this,function(p){switch(p.label){case 0:return this.initPopover(b.popoverDetails.popoverName),
this.popoverSkeleton.show(),this.popoverWidgetList.hide(),this.popoverSkeleton.setLoadingAnimation(!0),b.popoverDetails.popover?[4,b.popoverDetails.popover.showSync()]:[3,2];case 1:p.sent(),p.label=2;case 2:c=this.popoverWidgetList.doesPopoverExists(b.reviewId),d=0,p.label=3;case 3:p.trys.push([3,9,,10]),p.label=4;case 4:if(c)return[3,6];e=0===d;return[4,this.fetchAnotherPopoversPage(b.asin,b.mediaType,e)];case 5:return f=p.sent(),c=this.popoverWidgetList.doesPopoverExists(b.reviewId),d++,f?[3,4]:
[3,6];case 6:if(c)return[3,8];k=na.setup(["renderPopover"]);return[4,k.renderPopover({reviewId:b.reviewId})];case 7:n=p.sent(),this.popoverWidgetList.addPopovers(n),this.popoverWidgetList.setNextToken(""),c=!0,H.logCounter("mobileweb.missingReviewId",1),p.label=8;case 8:return this.popoverWidgetList.show(),c&&this.popoverWidgetList.scrollTo(b.reviewId,b.mediaId),this.popoverSkeleton.hide(),[3,10];case 9:return p.sent(),H.logCounter("mobile.popoverLoading.Error",1),this.popoverSkeleton.setLoadingAnimation(!1),
r=new ka("loadPopoverError"),r.setClickParams(new Map([["data-popovername",b.popoverDetails.popoverName],["data-asin",b.asin],["data-mediatype",b.mediaType.toString()],["data-reviewid",b.reviewId],["data-mediaid",b.mediaId]])),r.show(),[3,10];case 10:return this.popoverWidgetList.setOnScrollCallback(function(){5>=v.popoverWidgetList.getNumberOfPopoversLeft()&&v.fetchAnotherPopoversPage(b.asin,b.mediaType)}),[2]}})})};a.prototype.resetOverlayComponents=function(){(new ya).hide();(new ka("loadPopoverError")).hide();
(new ka("reportAbuseThankYouMessage")).hide()};a.prototype.showReportAbuseConfirmationDialog=function(b,c){a.currentScreen=ha.ReportAbuseConfirmationDialog;var d=new ya;d.setReviewId(b);d.setAsin(c);d.show()};a.prototype.back=function(){switch(a.currentScreen){case ha.Popover:case ha.Gallery:qa.getPopoverByName(a.popoverName).hide();break;case ha.ReportAbuseConfirmationDialog:(new ya).hide(),a.currentScreen=ha.Popover}};a.prototype.fetchAnotherPopoversPage=function(b,c,d){void 0===d&&(d=!1);return g.__awaiter(this,
void 0,void 0,function(){var e,f;return g.__generator(this,function(k){switch(k.label){case 0:e=this.popoverWidgetList.getNumberOfPopoversLoaded();f=this.popoverWidgetList.getNextToken();if(!(d||!this.isAlreadyLoadingMedia&&f&&500>=e))return[3,5];this.isAlreadyLoadingMedia=!0;k.label=1;case 1:return k.trys.push([1,,3,4]),[4,this.loadPopovers(b,c,f)];case 2:return k.sent(),[3,4];case 3:return this.isAlreadyLoadingMedia=!1,[7];case 4:return[2,!0];case 5:return[2,!1]}})})};a.prototype.loadPopovers=function(b,
c,d){return g.__awaiter(this,void 0,void 0,function(){var e,f;return g.__generator(this,function(k){switch(k.label){case 0:return e=na.setup(["renderPopoverList"]),[4,e.renderPopoverList({asin:b,nextToken:d,mediaType:c,limit:50})];case 1:return f=k.sent(),this.popoverWidgetList.addPopovers(f),d=f.getAttribute("data-next-token"),this.popoverWidgetList.setNextToken(d),[2,d]}})})};return a}().getInstance(),Xb=function(){function a(){}a.prototype.onVideoClickHandler=function(b){var c;return g.__awaiter(this,
void 0,void 0,function(){var d,e,f,k,n,r,v,p,w=this;return g.__generator(this,function(m){d=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset;e=d.asin;f=d.physicalid;k=d.reviewid;n=d.extension;r=d.thumbnailurl;v=this.getRefMarker(d.rank);Aa["default"].trigger("a:declarative:reviews:open-mweb-immersive-video-modal:click",{$event:b.event,$target:b.currentTarget,data:{asin:e,filter:"video",isSingleReview:!0,mediaType:"video",metricsPrefix:"CarouselVideoToAppX",physicalId:f,refMarker:v,reviewId:k,
shouldTriggerRefTag:!0,slateImageUrl:r,url:"https://m.media-amazon.com/images/I/"+f+"."+n}});p=function(){w.refocusToMedia(f);Aa["default"].off("vse:ns:partialcomponents:vse_reviews_mobile:lightboxClosed",p)};Aa["default"].on("vse:ns:partialcomponents:vse_reviews_mobile:lightboxClosed",p);return[2]})})};a.prototype.refocusToMedia=function(b){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,function(c){return[2,new Promise(function(d,e){var f=T["default"].cardRoot.ownerDocument.querySelector('button[data-physicalid="'+
b+'"]');setTimeout(function(){null===f||void 0===f?void 0:f.focus();d()},0)})]})})};a.prototype.getRefMarker=function(b){return Tb.appendToString(b)};return a}(),Yb=function(){function a(){this.mWebImmersiveVideoClickHandler=new Xb}a.prototype.addMinHeightToParent=function(b){(b=T["default"].cardRoot.ownerDocument.querySelector("."+b))&&b.parentElement&&(b.parentElement.style.minHeight="inherit")};a.prototype.onVideoClickHandler=function(b){return g.__awaiter(this,void 0,void 0,function(){return g.__generator(this,
function(c){switch(c.label){case 0:return[4,this.mWebImmersiveVideoClickHandler.onVideoClickHandler(b)];case 1:return c.sent(),[2]}})})};a.prototype.onImageClickHandler=function(b){var c;return g.__awaiter(this,void 0,void 0,function(){var d,e,f,k,n;return g.__generator(this,function(r){switch(r.label){case 0:return d=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset,e=va["default"].cardRoot.getElementsByClassName("_Y3Itb_media-popover-container_2BBbs")[0],f="cr-media-popover",[4,vb.get(f,e,
b.currentTarget)];case 1:return k=r.sent(),n=C[d.mediatype],[4,ta.loadMediaPopover({mediaType:n,asin:d.asin,reviewId:d.reviewid,mediaId:d.physicalid,popoverDetails:{popoverName:f,popover:k}})];case 2:return r.sent(),this.addMinHeightToParent("_Y3Itb_media-popover-container_2BBbs"),b.currentTarget&&b.currentTarget.classList.remove("a-declarative"),[2]}})})};a.prototype.onSeeMoreClickHandler=function(b){var c;return g.__awaiter(this,void 0,void 0,function(){var d,e,f,k;return g.__generator(this,function(n){d=
null===(c=b.currentTarget)||void 0===c?void 0:c.dataset;e=C[d.mediatype];f=za(e);k=d.asin;if(f===X.IMAGE)W["default"].setLocation(Ra(Sb.toString(),X.IMAGE,k));else throw H.logError("loadVideoGalleryError",f),Error("Video gallery is not available on mWeb.");return[2]})})};return a}(),Zb=function(){function a(){}a.getThumbnailClickHandler=function(){return g.__awaiter(this,void 0,void 0,function(){var b;return g.__generator(this,function(c){switch(c.label){case 0:return[4,Ua()];case 1:b=c.sent();switch(b){case V.MSHOP:return[2,
new Ub];case V.MWEB:return[2,new Yb];case V.DESKTOP:return[2,new Nb]}return[2]}})})};return a}(),$b=function(){function a(b){this.clickHandler=this.clickHandler=b}a.prototype.registerThumbnailClickHandlers=function(){this.registerCRVideoThumbnailClickHandler();this.registerCRImageThumbnailClickHandler();this.registerCRSeeMoreThumbnailClickHandler()};a.prototype.registerCRVideoThumbnailClickHandler=function(){var b=this,c=J["default"].setup().define;c(tb.clickHandler,"click",function(d){return g.__awaiter(b,
void 0,void 0,function(){return g.__generator(this,function(e){switch(e.label){case 0:return[4,this.clickHandler.onVideoClickHandler(d)];case 1:return e.sent(),H.logCounter("videoThumbnail.click",1),[2]}})})})};a.prototype.registerCRImageThumbnailClickHandler=function(){var b=this,c=J["default"].setup().define;c(rb.clickHandler,"click",function(d){return g.__awaiter(b,void 0,void 0,function(){return g.__generator(this,function(e){switch(e.label){case 0:return[4,this.clickHandler.onImageClickHandler(d)];
case 1:return e.sent(),H.logCounter("imageThumbnail.click",1),[2]}})})})};a.prototype.registerCRSeeMoreThumbnailClickHandler=function(){var b=this,c=J["default"].setup().define;c(sb.clickHandler,"click",function(d){return g.__awaiter(b,void 0,void 0,function(){var e,f;return g.__generator(this,function(k){switch(k.label){case 0:return[4,this.clickHandler.onSeeMoreClickHandler(d)];case 1:return k.sent(),e=C[null===(f=d.currentTarget)||void 0===f?void 0:f.dataset.mediatype],H.logCounter("seeMore."+
e.toLowerCase()+".click",1),[2]}})})})};return a}(),Oa;(Oa||(Oa={})).closePopoverClickHandler="ClosePopoverClickHandler";var ac=function(){function a(){}a.registerClosePopoverClickHandler=function(){var b=J["default"].setup().define;b(Oa.closePopoverClickHandler,"click",function(c){c.stopBubble();ta.back()})};return a}(),ua;(function(a){a.expandTextClickHandler="expandTextClickHandler";a.hideTextClickHandler="hideTextClickHandler";a.toggleTextClickHandler="toggleTextClickHandler"})(ua||(ua={}));var bc=
function(){function a(){}a.registerTextExpanderClickHandlers=function(){a.registerExpandTextClickHandler();a.registerHideTextClickHandler();a.registerToggleTextClickHandler()};a.registerExpandTextClickHandler=function(){var b=J["default"].setup().define;b(ua.expandTextClickHandler,"click",function(c){c.stopBubble();c=a.getTextExpanderClient(c);null===c||void 0===c?void 0:c.expandText()})};a.registerHideTextClickHandler=function(){var b=J["default"].setup().define;b(ua.hideTextClickHandler,"click",
function(c){c.stopBubble();c=a.getTextExpanderClient(c);null===c||void 0===c?void 0:c.hideText()})};a.registerToggleTextClickHandler=function(){var b=J["default"].setup().define;b(ua.toggleTextClickHandler,"click",function(c){c.stopBubble();c=a.getTextExpanderClient(c);null===c||void 0===c?void 0:c.toggleText()})};a.getTextExpanderClient=function(b){var c;b=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset.reviewid;return Na(N.getPopoverWidgetById(b))};return a}(),bb=function(){function a(){this.errorDialog=
T["default"].cardRoot.ownerDocument.querySelector("._Y3Itb_media-popover-error-dialog_2LoQP")}a.prototype.show=function(){G(this.errorDialog)};a.prototype.hide=function(){D(this.errorDialog)};return a}(),Pa;(Pa||(Pa={})).closeToastBar="closeToastBarClickHandler";var cb=function(){function a(){}a.registerCloseToastBarClickHandler=function(){var b=J["default"].setup().define;b(Pa.closeToastBar,"click",function(c){c.stopBubble();c=c.currentTarget.closest("div[data-toast-bar-name='"+c.currentTarget.dataset.toastBarName+
"']");x(c,function(d){return D(d)})})};return a}(),cc=function(){function a(){}a.prototype.registerMediaPopoverClickHandlers=function(){ac.registerClosePopoverClickHandler();this.registerOpenPopoverReportConfirmationDialog();this.registerHelpfulVoteClickHandler();this.registerMediaOverlayClickHandlers();this.registerNoopHandler();this.registerConfirmReportAbuseClickHandler();this.registerClosePopoverErrorDialogClickHandler();this.registerLoadMediaPopoverClickHandler();cb.registerCloseToastBarClickHandler()};
a.prototype.registerNoopHandler=function(){var b=J["default"].setup().define;b(U.noopHandler,"click",function(c){c.stopBubble()})};a.prototype.registerMediaOverlayClickHandlers=function(){this.registerMediaOverlayNavigationClickHandlers();bc.registerTextExpanderClickHandlers()};a.prototype.registerClosePopoverErrorDialogClickHandler=function(){var b=J["default"].setup().define;b(U.closePopoverErrorDialogClickHandler,"click",function(c){c.stopBubble();(new bb).hide()})};a.prototype.registerMediaOverlayNavigationClickHandlers=
function(){var b=J["default"].setup().define;b(U.popoverClickHandler,"click",function(c){var d=c.event,e=c.currentTarget;var f=d.clientX/e.clientWidth*100;d=d.clientY/e.clientHeight*100;e=(e.clientWidth>e.clientHeight?ra.LANDSCAPE:ra.POTRAIT)===ra.POTRAIT?{lowerBound:33,upperBound:67}:{lowerBound:40,upperBound:80};f=d<=e.lowerBound||d>=e.upperBound?O.NONE:25>=f?O.LEFT:75<=f?O.RIGHT:O.CENTER;(new N(N.getPopoverWidgetById(c.currentTarget.dataset.reviewid))).handlePopoverClick(f)});b(U.desktopRightClickHandler,
"click",function(c){(new N(N.getPopoverWidgetById(c.currentTarget.dataset.reviewid))).handlePopoverClick(O.RIGHT)});b(U.desktopLeftClickHandler,"click",function(c){(new N(N.getPopoverWidgetById(c.currentTarget.dataset.reviewid))).handlePopoverClick(O.LEFT)})};a.prototype.registerOpenPopoverReportConfirmationDialog=function(){var b=J["default"].setup().define;b(U.openReportConfirmationDialogClickHandler,"click",function(c){c.stopBubble();ta.showReportAbuseConfirmationDialog(c.currentTarget.dataset.id,
c.currentTarget.dataset.asin)})};a.prototype.showErrorDialog=function(){(new ya).hide();(new bb).show()};a.prototype.registerConfirmReportAbuseClickHandler=function(){var b=this,c=J["default"].setup().define,d=pa["default"].setup(["reportAbuse"]);c(U.confirmReportAbuseClickHandler,"click",function(e){e.stopBubble();var f=e.currentTarget.firstChild.dataset.id;e=e.currentTarget.firstChild.dataset.asin;d.reportAbuse({reviewId:f,domain:oa(),asin:e}).then(function(k){!k.success&&k.redirectUrl?W["default"].setLocation(k.redirectUrl):
k.success?(ta.back(),(new N(N.getPopoverWidgetById(f))).scrollIntoNextPopover(),(new ka("reportAbuseThankYouMessage")).show()):b.showErrorDialog()})})};a.prototype.registerHelpfulVoteClickHandler=function(){var b=this,c=J["default"].setup().define,d=pa["default"].setup(["helpful"]);c(U.helpfulVoteClickHandler,"click",function(e){e.stopBubble();var f=e.currentTarget.dataset.id;e=e.currentTarget.dataset.asin;d.helpful({reviewId:f,domain:oa(),asin:e}).then(function(k){!k.success&&k.redirectUrl?W["default"].setLocation(k.redirectUrl):
k.success?(new Ma(Ma.getActionButtonsContainer(f))).likeButtonClicked():b.showErrorDialog()})})};a.prototype.registerLoadMediaPopoverClickHandler=function(){var b=this,c=J["default"].setup().define;c(U.loadMediaPopover,"click",function(d){return g.__awaiter(b,void 0,void 0,function(){var e,f,k,n;return g.__generator(this,function(r){switch(r.label){case 0:return e=new ab,f=null===(n=d.currentTarget)||void 0===n?void 0:n.dataset,k=C[f.mediatype],e.show(),e.setLoadingAnimation(!0),[4,ta.loadMediaPopover({asin:f.asin,
mediaType:k,reviewId:f.reviewid,mediaId:f.mediaid,popoverDetails:{popoverName:f.popovername},isDesktop:!Ta()})];case 1:return r.sent(),[2]}})})})};return a}(),Q=J["default"].setup().define,R=function(a,b){x(a.currentTarget,function(c){var d=Wa(c);if(!d.mediaType)throw Error("unable to extract mediaType from element: "+a.operationName+", "+c.nodeName);var e=sa.getData(d.mediaType);if(!e)throw Error("unable to get modalManager: "+a.operationName+", "+d);b(e,d,c.dataset)})},dc=function(){Q(M.galleryItemClickHandler,
"click",function(a){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(b){R(a,function(c,d,e){if(!d.reviewId||!d.mediaId)throw Error("reviewId or mediaId was not found on the media gallery item: "+JSON.stringify(e));c.updateModalWithReview(d.reviewId,d.mediaId,d.mediaType)});return[2]})})})},ec=function(){Q(M.showMediaGalleryClickHandler,"click",function(a){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(b){R(a,function(c){return c.showMediaGallery()});
return[2]})})})},fc=function(){Q(M.reloadMediaPopover,"click",function(a){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(b){R(a,function(c,d,e){if("true"===e.showgalleryinmodal&&!d.asin)throw Error("asin was not found on the toastbar : "+JSON.stringify(e));if(!("true"===e.showgalleryinmodal||d.reviewId&&d.mediaId&&d.asin))throw Error("reviewId/mediaId/asin was not found on the toastbar : "+JSON.stringify(e));c.loadModal({asin:d.asin,mediaId:d.mediaId,reviewId:d.reviewId,
mediaType:d.mediaType,showGalleryInModal:"true"==e.showgalleryinmodal?!0:!1,popoverDetails:{popoverName:e.popovername}})});return[2]})})})},gc=function(){Q(M.thumbnailClickHandler,"click",function(a){R(a,function(b,c,d){if(!c.mediaId)throw Error("mediaId was not found while clicking on media thumbnail: "+d);b.updateMediaInModal(c.mediaId)})})},hc=function(){Q(M.rightClickHandler,"click",function(a){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(b){R(a,function(c){return c.handleModalMediaProgressionClick(O.RIGHT)});
return[2]})})});Q(M.leftClickHandler,"click",function(a){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(b){R(a,function(c){return c.handleModalMediaProgressionClick(O.LEFT)});return[2]})})})},ic=function(){Q(M.expandTextClickHandler,"click",function(a){R(a,function(b){return b.handleExpanderClick(ja.EXPAND)})});Q(M.hideTextClickHandler,"click",function(a){R(a,function(b){return b.handleExpanderClick(ja.HIDE)})})},jc=function(){Q(M.openReportConfirmationDialogClickHandler,
"click",function(a){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(b){R(a,function(c){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(d){c.openReportAbuseDialog(a.currentTarget);return[2]})})});return[2]})})});Q(M.confirmReportAbuseClickHandler,"click",function(a){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(b){R(a,function(c){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,
function(d){c.handleReportAbuseClick();return[2]})})});return[2]})})})},kc=function(){Q(M.helpfulVoteClickHandler,"click",function(a){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(b){R(a,function(c){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,function(d){c.handleHelpulVoteClick();return[2]})})});return[2]})})})},lc=function(){Q(M.closeMediaPopover,"click",function(a){R(a,function(b){return g.__awaiter(void 0,void 0,void 0,function(){return g.__generator(this,
function(c){b.closeModal();return[2]})})})})},mc=function(){Q(M.noopHandler,"click",function(a){a.stopBubble()})},nc=function(){Q(M.translateClickHandler,"click",function(a){return g.__awaiter(void 0,void 0,void 0,function(){var b,c;return g.__generator(this,function(d){b=null===(c=a.currentTarget)||void 0===c?void 0:c.dataset.reviewid;if(!b)throw Error("reviewId not defined");R(a,function(e){e.showTranslateSpinner();pa["default"].setup(["translateReview"]).translateReview({reviewId:b}).then(function(f){if(f){if(e.updateReviewTranslate(f.reviewTitle,
f.reviewText,f.reviewLanguage),f=a.currentTarget,f.style.display="none",f=f.parentNode){var k=Y(f,z.TranslationInfoBlock);k&&(k.style.display="inline-block");if(k=Y(f,z.TranslationSeeOriginalBlock))k.style.display="inline-block";if(f=Y(f,z.TranslateErrorDialog))f.style.display="none"}}else throw Error("Unable to translate the review");}).catch(function(f){e.showTranslationErrorDialog()}).finally(function(){e.hideTranslateSpinner()})});return[2]})})})},oc=function(){Q(M.seeOriginalClickHandler,"click",
function(a){return g.__awaiter(void 0,void 0,void 0,function(){var b,c,d,e,f;return g.__generator(this,function(k){b=a.currentTarget;c=(null===b||void 0===b?void 0:b.dataset)||{};d=c.reviewid;e=c.mediaid;f=c.mediatype;if(d&&e&&f)R(a,function(n){n.updateModalWithReview(d,e,f);n.handleExpanderClick(ja.EXPAND)});else throw Error("reviewId, mediaId or mediaType not defined");return[2]})})})},pc=function(){return g.__awaiter(void 0,void 0,void 0,function(){var a,b;return g.__generator(this,function(c){switch(c.label){case 0:return[4,
Ua()];case 1:a=c.sent();switch(a){case V.DESKTOP:dc();ec();fc();gc();hc();ic();jc();kc();mc();lc();cb.registerCloseToastBarClickHandler();nc();oc();break;case V.MWEB:b=new cc,b.registerMediaPopoverClickHandlers()}return[2]}})})};Qa._operationNames=[];Qa.card=function(){return g.__awaiter(void 0,void 0,void 0,function(){var a,b;return g.__generator(this,function(c){switch(c.label){case 0:return H.setPrefix("cr-media-carousel"),[4,Zb.getThumbnailClickHandler()];case 1:return a=c.sent(),b=new $b(a),
b.registerThumbnailClickHandlers(),[4,Ea()];case 2:return c.sent()?[3,4]:[4,pc()];case 3:c.sent(),c.label=4;case 4:return H.logCounter("client.loaded",1),[2]}})})}});
